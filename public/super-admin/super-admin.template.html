<div class="navbar-fixed" >
	<nav class="nav-extended  blue darken-4" style="padding-right: 30px;">
		<div class="nav-wrapper">
	  		<a href="#" class="brand-logo thin" id="logoSB">
	  			<img id="logoCabecera" src="img/logo.png" />
	  			Sistema de Becas NU
	  		</a>
	  		<ul class="right hide-on-med-and-down">
	  			<li><i class="material-icons left">account_circle</i><b>Super Administrador</b></li>
	  			<li><a class="btn-floating waves-effect waves-light red" ng-click="$ctrl.close()"><i class="material-icons left">power_settings_new</i></a></li>
	  		</ul>
		</div>
	</nav>
</div>

<div class="container">
	<div class="row card">
		<div class="card-content">
			<div class="row">
				<div class="col xl2 l2 m2 center-align">
					<button id="adduser" class="btn-large btn-floating waves-effect waves-light orange" data-target="addusermodal"><i class="material-icons left">person_add</i></button><br>
					<span class="grey-text">Nuevo Usuario</span>
				</div>
				<div class="input-field col xl8 l8 m8 offset-xl1 offset-l1 offset-m1">
		          	<input id="search" type="search" placeholder="Buscar por nombre, nombre de usuario, matricula" ng-model="$ctrl.searchText">
		          	<label class="label-icon" for="search"><i class="material-icons">search</i></label>
		          	<i class="material-icons" ng-click="$ctrl.searchText = '' ">close</i>
				</div>
			</div>
			<div class="row">
				<div class="col xl10 l10 m10">
					<h5 class="Xcard-title orange-text"><i class="material-icons left">group</i>Lista de Usuarios</h5>
				</div>				
			</div>
			<div class="row">
				<div class="col xl12 l12 m12">
					<ul  class="collapsible popout" data-collapsible="accordion">
						<li ng-repeat="user in $ctrl.users | filter:$ctrl.searchText" ng-if="user.matricula != 'adminSuper'">
							<div class="collapsible-header" ng-click="$ctrl.edit = true">
								<i class="material-icons">visibility</i>
								{{user.nombre}} {{user.apellido1}} ({{user.matricula}})
							</div>
							<div class="collapsible-body">
								<div class="section">
									<form ng-submit="$ctrl.updateUser(user)">
									<table class="responsive-table">
										<thead>
											<th>Username</th>
											<th>Nombre</th>
											<th>Apellido1</th>
											<th>Apellido2</th>
											<th>Rol</th>
											<th>password</th>
										</thead>
										<tbody>
											<tr>
												<td>
													{{user.matricula}}
												</td>
												<td>
													<input type="text" ng-model="user.nombre" ng-disabled="$ctrl.edit" required pattern="[A-Za-z\\\sÑÁÉÍÓÚáéíóú]{2,40}" title="Verifique que el campo no contenga caracteres especiales, solo letras" maxlength="40" class="validate upper" >
												</td>
												<td>
													<input type="text" ng-model="user.apellido1" ng-disabled="$ctrl.edit" required pattern="[A-Za-z\\\sÑÁÉÍÓÚáéíóú]{2,40}" title="Verifique que el campo no contenga caracteres especiales, solo letras"  maxlength="40" class="validate upper">
												</td>
												<td>
													 <input type="text" ng-model="user.apellido2" ng-disabled="$ctrl.edit" pattern="[A-Za-z\\\sÑÁÉÍÓÚáéíóú]{0,40}" title="Verifique que el campo no contenga caracteres especiales, solo letras" maxlength="40" class="validate upper">
												</td>
												<td ng-if="user.isAdmin == true">
														Evaluador
												</td>
												<td ng-if="user.isAdmin != true">
														Estudiante
												</td>
												<td>
													<input type="password" ng-model="user.password" ng-disabled="$ctrl.edit" required pattern="^[a-zA-Z0-9ñÑ]{1,30}$" title="Verifique que el campo no contenga caracteres especiales" maxlength="30"/>
												</td>
											</tr>
										</tbody>
									</table>
									<div class="row" ng-hide="$ctrl.edit" >
										<div class="col xl12 l12 m12">
											<button class="btn waves-effect waves-light "><i class="material-icons left" type="submit">save</i>Guardar</button>
											<a class="btn waves-effect waves-light red" ng-click="$ctrl.leerUsuarios()"><i class="material-icons left" >cancel</i>Cancelar</a>
										</div>
									</div>
									</form>
								</div>
								<div class="section">
									<a ng-click="$ctrl.edit=!$ctrl.edit" class="btn-floating waves-effect waves-light"><i class="material-icons left">edit</i> </a>
									<button  ng-click="$ctrl.deleteUser(user.matricula)" class="btn-floating waves-effect waves-light"><i class="material-icons left red">delete</i> </button>
								</div>
							</div>
						</li>
					</ul>
				</div>
			</div>
		</div>
	</div>
</div>

<!--Modal para agregar un usuario-->
<div id="addusermodal" class="modal modal-fixed-footer">
	<form ng-submit="$ctrl.addUser()">    
	    <div class="modal-content">
	        <h5 class="orange-text"><i class="material-icons left">person_add</i>Nuevo usuario</h5>
			<div class="row">
		      	<div class="row">
		      		<div class="input-field col xl2 l2 m2">
		      			<label>Rol: </label>
		      		</div>
		      		<div class="input-field col xl10">	      			
		      			<input ng-init="$ctrl.role = 'Evaluador'" name="group1" type="radio" id="eval" ng-model="$ctrl.role"  value="Evaluador"/>
				     	<label for="eval">Evaluador</label>
				    	<input name="group1" type="radio" id="estu" ng-model="$ctrl.role"  value="Estudiante" />
				     	<label for="estu">Estudiante</label>	
		      		</div>
					<br><br><br>
		      		<div class="input-field col xl4 l4 m4">
		      			<i class="material-icons prefix">account_circle</i>

			    		<input id="newusername" type="text" ng-model="$ctrl.name" required pattern="[A-Za-z\\\sÑÁÉÍÓÚáéíóú]{2,40}" title="Verifique que el campo no contenga caracteres especiales, solo letras" maxlength="40" class="validate upper" >
			    		<label for="newusername">Nombre</label>
		      		</div>
			      	
			      	<div class="input-field col xl4 l4 m4">
				      	<input id="newuserAp1" type="text" ng-model="$ctrl.apellido1" required pattern="[A-Za-z\\\sÑÁÉÍÓÚáéíóú]{2,40}" title="Verifique que el campo no contenga caracteres especiales, solo letras"  maxlength="40" class="validate upper">
				    	<label for="newuserAp1">Apellido paterno</label>
			      	</div>

			      	<div class="input-field col xl4 l4 m4">
				      	<input id="newuserAp2" type="text" ng-model="$ctrl.apellido2" pattern="[A-Za-z\\\sÑÁÉÍÓÚáéíóú]{0,40}" title="Verifique que el campo no contenga caracteres especiales, solo letras" maxlength="40" class="validate upper">
				    	<label for="newuserAp2">Apellido materno</label>
			      	</div>

			      	
			      	<div ng-switch on = "$ctrl.role">
			      		<div class="input-field col xl12 l12 m12" ng-switch-when="Estudiante">
				      		<i class="material-icons prefix">perm_identity</i>
					      	<input id="newusercid1" type="text" class="validate" ng-model="$ctrl.username" pattern="(^011[1-9]0[1-9]00[0-9][0-9])" required title="Introduce una matricula válida: 011X0X00XX">
					    	<label for="newusercid1">Nombre de Usuario (011X0X00XX)</label>
				      	</div>	
				      	<div class="input-field col xl12 l12 m12" ng-switch-when="Evaluador">
				      		<i class="material-icons prefix">perm_identity</i>
					      	<input id="newusercid2" type="text" class="validate" ng-model="$ctrl.username" pattern="admin[A-Za-z]{5,15}" required title="Usa la palabra 'admin' seguida de 5 a 15 caracteres(NO espacios): adminXXX...X">
					    	<label for="newusercid2">Nombre de Usuario (adminXXX...X)</label>
				      	</div>
			      	</div>

			      	<div class="input-field col xl12 l12 m12">
			      		<i class="material-icons prefix">lock</i>
				      	<input id="password" type="password" class="validate" ng-model="$ctrl.password" required pattern="^[a-zA-Z0-9ñÑ]{1,30}$" title="Verifique que el campo no contenga caracteres especiales" maxlength="30">
				    	<label for="password">Contraseña</label>
			      	</div>	
		      	</div>
	      	</div>
	    </div>

		<div class="modal-footer">
	    	<a class="modal-action modal-close waves-effect waves-green btn-flat" >Cancelar</a>
	    	<input class="waves-effect waves-green btn-flat" type="submit" value="Agregar" />
		</div>
	</form>
</div>
<footer-becas></footer-becas>